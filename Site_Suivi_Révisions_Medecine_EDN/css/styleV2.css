/* --------- Base --------- */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* Scrollbars personnalisées (plus jolies/fines) */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}
::-webkit-scrollbar-track {
  background: rgba(0,0,0,0.05);
  border-radius: 3px;
}
::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 3px;
}
::-webkit-scrollbar-thumb:hover {
  background: #aaa;
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f5f6fa;
  color: #222;
  min-height: 100vh;
}

a {
  color: inherit;
  text-decoration: none;
}

/* --------- Header --------- */

.header {
  background: #2f7e5f;
  color: #fff;
  padding: 16px 18px 18px;
  position: relative;
}

.planning-page .header {
  position: sticky;
  top: 0;
  z-index: 800;
}

.header-top {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  /* AJOUT : Nécessaire pour centrer le bouton par rapport à ce bloc */
  position: relative; 
}

.main-nav {
  display: flex;
  gap: 8px;
}

.nav-link {
  padding: 8px 18px;
  border-radius: 999px;
  background: rgba(255,255,255,0.14);
  font-size: 15px;
}

.nav-link.active {
  background: #fff;
  color: #2f7e5f;
  font-weight: 600;
}

/* --------- Deadline --------- */

.deadline-box {
  margin-top: 14px;
  text-align: center;
}

.deadline-title {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 6px;
}

.deadline-progress-bar-background {
  width: 100%;
  max-width: 600px;
  margin: 0 auto 6px;
  height: 18px;
  background: rgba(255,255,255,0.2);
  border-radius: 999px;
  overflow: hidden;
}

.deadline-progress-bar-fill {
  height: 100%;
  width: 0;
  background: linear-gradient(90deg, #ffe082, #ff7043);
  transition: width 3s cubic-bezier(0.22, 1, 0.36, 1);
}

#deadline-countdown {
  font-size: 14px;
  opacity: 0.9;
}

/* Sous-menu planning */

.sub-nav {
  margin-top: 14px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  font-size: 14px;
}

.sub-nav a {
  padding: 6px 12px;
  background: #ffffff;
  color: #2f7e5f;
  border-radius: 999px;
  font-weight: 600;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Bouton motivation */

.motivation-btn {
  margin-top: 10px;
  padding: 8px 14px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  background: #ffb74d;
  color: #4e342e;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

.motivation-btn:hover {
  filter: brightness(0.97);
}

.motivation-box {
  margin: 15px auto 0;
  width: fit-content;
  max-width: 90%;
  background: rgba(255,255,255,0.95);
  color: #2f2f2f;
  border-radius: 12px;
  padding: 12px 24px;
  font-size: 15px;
  font-weight: 500;
  line-height: 1.5;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-5px); }
  to { opacity: 1; transform: translateY(0); }
}

/* --------- Container --------- */

.container {
  max-width: 1020px;
  margin: 18px auto 40px;
  padding: 0 16px;
}

.planning-container {
  max-width: 1400px;
}

/* --------- Progression globale --------- */

.progress-section {
  margin-bottom: 20px;
}

.progress-bar-background {
  width: 100%;
  height: 22px;
  background: #e3e5e9;
  border-radius: 999px;
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  width: 0;
  background: linear-gradient(90deg, #f46b45, #76b852);
  transition: width 3s cubic-bezier(0.22, 1, 0.36, 1);
}

.progress-text {
  margin-top: 8px;
  font-weight: 600;
  text-align: center;
}

/* --------- Contrôles --------- */

.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  align-items: flex-end;
  margin-bottom: 24px;
}

.search-wrapper {
  flex: 0 1 320px;
  max-width: 200px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.search-wrapper input {
  padding: 8px 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 14px;
}

.filters-wrapper {
  display: flex;
  align-items: center;
  font-size: 13px;
  gap: 6px;
}

.filters-wrapper input {
  margin-right: 4px;
}

.buttons-wrapper {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

button {
  padding: 8px 12px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  background: #2f7e5f;
  color: white;
  transition: transform 0.05s ease-out, box-shadow 0.1s;
}

button:hover {
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
}

button:active {
  transform: translateY(1px);
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

/* --------- Liste chapitres --------- */

.chapters-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 8px;

  height: 85vh;       /* Occupe 65% de la hauteur de l'écran quoi qu'il arrive */
  min-height: 400px;  /* Sécurité pour les petits écrans */
  
  overflow-y: auto;   /* La barre de défilement apparaît à l'intérieur */
  padding-right: 4px;
  
  /* Optionnel : petite bordure pour délimiter la zone fixe */
  border: 1px solid rgba(0,0,0,0.05);
  border-radius: 8px;
  padding: 10px;
  background: rgba(255,255,255,0.5); /* Fond léger pour matérialiser la zone */
}

.chapter-item {
  background: #ffffff;
  border-radius: 8px;
  padding: 10px 12px;
  display: flex;
  align-items: flex-start;
  gap: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
}

.chapter-item.completed {
  background: #e7f7ed;
}

.chapter-checkbox {
  margin-top: 3px;
}

.chapter-label {
  cursor: pointer;
  width: 100%;
}

.chapter-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 2px;
}

.chapter-title {
  font-weight: 600;
}

.chapter-info-btn {
  padding: 4px 8px;
  font-size: 12px;
  border-radius: 999px;
  background: #e3f2fd;
  color: #1e88e5;
  border: none;
  cursor: pointer;
  white-space: nowrap;
}

.chapter-info-btn:hover {
  box-shadow: 0 1px 4px rgba(0,0,0,0.15);
}

.chapter-subtitle {
  font-size: 13px;
  color: #555;
}

/* --------- Sections planning --------- */

.today-header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.today-nav {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  margin: 8px 0 4px;
}

.today-label {
  font-weight: 600;
  font-size: 14px;
}

.nav-button {
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid #2f7e5f;
  background: #2f7e5f;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
}

.nav-button:hover {
  background: #e61624;
}

.planning-section {
  margin-bottom: 32px;
}

.planning-section h2 {
  margin-bottom: 6px;
}

.section-note {
  font-size: 13px;
  color: #555;
  margin-bottom: 10px;
}

/* Prochaines re-révisions (AJOUT SCROLL) */

.reviews-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 100px;
  max-height: 500px;
  overflow-y: auto;
  padding-right: 8px;
  border: 1px solid #f0f0f0;
  border-radius: 8px;
  padding: 8px;
}

.review-item {
  background: #fff;
  border-radius: 10px;
  padding: 10px 12px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
  gap: 4px;
  border-left: 4px solid #2f7e5f;
}

.review-item.done {
  background: #e8f5e9;
  border-left-color: #2e7d32;
}

.review-item.failed {
  background: #ffebee;
  border-left-color: #c62828;
}

.today-controls {
  margin: 8px 0 12px;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.review-main-line {
  display: flex;
  justify-content: space-between;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.review-left {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.review-actions {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
  font-size: 12px;
}

.review-done-checkbox {
  cursor: pointer;
  accent-color: #2f7e5f;
}

.review-postpone-btn {
  border: none;
  cursor: pointer;
  padding: 3px 8px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
  background: #ffe082;
}

.review-postpone-btn:hover {
  filter: brightness(0.95);
}

.review-date {
  font-weight: 600;
}

.review-chapter-link {
  display: inline-block;
  padding: 2px 10px;
  border-radius: 999px;
  background: #e3f2fd;
  color: #1a237e;
  text-decoration: none;
  cursor: pointer;
  font-weight: 600;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.review-chapter-link:hover {
  background: #bbdefb;
}

.review-meta {
  font-size: 12px;
  color: #555;
}

/* Vue hebdo (AJOUT SCROLL & TAILLE FIXE) */

.week-controls,
.month-controls {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
}

.week-label,
.month-label {
  font-weight: 600;
}

.week-view {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 8px;
  table-layout: fixed;
}

.week-day {
  background: #fff;
  border-radius: 10px;
  padding: 8px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);
  font-size: 13px;
  display: flex;
  flex-direction: column;
  height: 250px;
  min-height: 250px;
  max-height: 250px;
  overflow: hidden;
}

.week-day.today {
  border: 2px solid #2f7e5f;
}

.week-day-title {
  font-weight: 700;
  margin-bottom: 6px;
  flex-shrink: 0;
}

.week-day-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 6px;
  flex-grow: 1;
  overflow-y: auto;
  padding-right: 4px;
  min-height: 0;
}

.week-review {
  font-size: 12px;
}

.week-review a {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  background: #ffe0b2;
  color: #ef6c00;
  font-weight: 600;
  text-decoration: none;
}

.week-review a:hover {
  filter: brightness(0.95);
}

.week-review a,
.month-review a {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.week-review.done a {
  background: #e8f5e9;
  color: #2e7d32;
}

.week-review.failed a {
  background: #ffebee;
  color: #c62828;
}

.week-review.moved-original a {
  text-decoration: line-through;
  opacity: 0.7;
}

.week-review.moved-child {
  padding-left: 10px;
}

/* Vue mensuelle (AJOUT SCROLL & TAILLE FIXE) */

.month-view {
  background: #fff;
  border-radius: 12px;
  padding: 10px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.08);
}

.month-grid {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  table-layout: fixed; 
}

.month-grid th,
.month-grid td {
  border: 1px solid #e0e0e0;
  vertical-align: top;
  padding: 4px;
}

.month-grid td {
  height: 200px;
  min-height: 200px;
  max-height: 200px;
  overflow-y: auto; /* <--- C'est ça qui permet de scroller DANS la case */
  display: block;   /* Assure que le scroll fonctionne bien */
}

.month-grid th {
  text-align: center;
  background: #f0f4c3;
  font-weight: 700;
  height: 30px;
}

.month-grid td.today {
  background: #e3f2fd;
}

.month-day-number {
  font-weight: 700;
  font-size: 11px;
  margin-bottom: 4px;
}

.month-day-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 4px;
  max-height: 180px;
  overflow-y: auto;
  padding-right: 2px;
}

.month-review a {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  background: #ffe0b2;
  color: #ef6c00;
  font-weight: 600;
  text-decoration: none;
  font-size: 11px;
}

.month-review a:hover {
  filter: brightness(0.95);
}

.month-review.done a {
  background: #e8f5e9;
  color: #2e7d32;
}

.month-review.failed a {
  background: #ffebee;
  color: #c62828;
}

.month-review.moved-original a {
  text-decoration: line-through;
  opacity: 0.7;
}

.month-review.moved-child {
  padding-left: 10px;
}

/* --------- Modal chapitre --------- */

.modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal.open {
  display: flex;
}

.modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.4);
}

.modal-content {
  position: relative;
  background: #fff;
  border-radius: 16px;
  max-width: 560px;
  width: 95%;
  max-height: 90vh;
  overflow: auto;
  padding: 20px 18px 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.25);
}

.modal-close {
  position: absolute;
  right: 10px;
  top: 8px;
  background: transparent;
  color: #333;
  box-shadow: none;
  font-size: 18px;
}

.modal-close:hover {
  background: #eee;
}

.modal-header-block {
  margin-bottom: 8px;
}

.modal-title {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 4px;
}

.modal-desc {
  font-size: 14px;
  color: #444;
}

.modal-meta {
  font-size: 13px;
  color: #555;
  margin: 10px 0 6px;
}

.modal-meta p + p {
  margin-top: 2px;
}

.modal-progress-container {
  margin-bottom: 10px;
}

.modal-progress-label {
  font-size: 12px;
  margin-bottom: 3px;
}

.modal-progress-bg {
  width: 100%;
  height: 10px;
  border-radius: 999px;
  background: #e0e0e0;
  overflow: hidden;
}

.modal-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #66bb6a, #2e7d32);
  transition: width 3s cubic-bezier(0.22, 1, 0.36, 1);
}

.modal-reviews-list {
  list-style: none;
  margin-top: 10px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.modal-review-item {
  font-size: 13px;
  display: flex;
  gap: 8px;
  align-items: flex-start;
  padding: 8px 10px;
  background: #f5f5f5;
  border-radius: 8px;
}

.modal-review-item input {
  margin-top: 2px;
}

.modal-review-item.moved-original .modal-review-label {
  text-decoration: line-through;
  opacity: 0.7;
}

.modal-review-item.moved-child {
  padding-left: 16px;
}

.review-item.moved-original .review-chapter-link,
.review-item.moved-original .review-meta {
  text-decoration: line-through;
  opacity: 0.7;
}

.review-item.moved-child {
  padding-left: 16px;
}

/* --------- Mini modal --------- */

.mini-modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1500;
}

.mini-modal.open {
  display: flex;
}

.mini-modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.35);
}

.mini-modal-content {
  position: relative;
  background: #fff;
  border-radius: 14px;
  max-width: 360px;
  width: 92%;
  padding: 16px 16px 14px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  z-index: 1501;
}

.mini-modal-content h3 {
  margin-bottom: 6px;
  font-size: 16px;
}

.mini-modal-content p {
  font-size: 13px;
  margin-bottom: 8px;
}

.mini-modal-content input[type="date"] {
  width: 100%;
  padding: 6px 8px;
  font-size: 14px;
  border-radius: 6px;
  border: 1px solid #ccc;
  margin-bottom: 10px;
}

.mini-modal-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
}

/* --------- Toast --------- */

.toast {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  width: min(90%, 420px);
  background: #2f7e5f;
  color: #fff;
  padding: 18px 24px;
  border-radius: 16px;
  font-size: 16px;
  text-align: center;
  box-shadow: 0 6px 18px rgba(0,0,0,0.3);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease, transform 0.25s ease;
  z-index: 2000;
}

.toast.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

/* --------- Responsive --------- */

@media (max-width: 950px) {
  .week-view {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 700px) {
  .header-top {
    flex-direction: column;
    align-items: flex-start;
  }

  .week-view {
    grid-template-columns: repeat(2, 1fr);
  }

  .month-grid th,
  .month-grid td {
    height: auto;
    min-height: 80px;
  }
}

@media (max-width: 500px) {
  .week-view {
    grid-template-columns: 1fr;
  }
}

/* --- Gestion du retard --- */

.review-item.late {
  border-left-color: #d32f2f;
  background: #ffebee;
}

.review-item.late .review-date {
  color: #c62828;
  font-weight: 800;
}

.review-item.late .review-meta {
  color: #b71c1c;
}

.late-badge {
  display: inline-block;
  margin-left: 8px;
  background: #d32f2f;
  color: #fff;
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 4px;
  vertical-align: middle;
}

.planning-options {
  margin-top: 24px;
}

.title-length-controls {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}

.meta-toggle-label {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 13px;
  cursor: pointer;
}

.title-length-controls input {
  width: 70px;
  padding: 4px 6px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 13px;
}

.planning-width-controls {
  margin-top: 10px;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
}

.planning-width-controls input {
  width: 90px;
  padding: 4px 6px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 13px;
}

.modal-review-move-btn {
  margin-left: 10px;
  padding: 2px 6px;
  font-size: 11px;
  border-radius: 4px;
  border: 1px solid #ccc;
  background: #f7f7f7;
  cursor: pointer;
}

.modal-review-move-btn:hover {
  background: #eaeaea;
}

.modal-review-reset-btn {
  margin-left: 8px;
  padding: 2px 6px;
  font-size: 11px;
  border-radius: 4px;
  border: 1px solid #ccc;
  background: #f7f7f7;
  cursor: pointer;
}

.modal-review-reset-btn:hover {
  background: #eaeaea;
}

.modal-review-item.done {
  background: #e8f5e9;
  border-left: 4px solid #2e7d32;
}

/* --- NOUVEAUX STYLES STATS AVANCEES --- */

.stats-summary-grid-4 {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.stat-card {
  background: #fff;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.stat-icon {
  font-size: 28px;
  background: #f0f4c3;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.stat-info h3 {
  font-size: 13px;
  color: #666;
  margin-bottom: 4px;
}

.stat-value {
  font-size: 18px;
  font-weight: 700;
  color: #2f7e5f;
}

/* Section grille secondaire */
.stats-grid-secondary {
  margin-bottom: 24px;
}

.stats-grid-secondary.single-box {
  display: flex;
  justify-content: center;
}

.stat-box {
  background: #fff;
  border-radius: 12px;
  padding: 18px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  width: 100%;
}

/* Boîte Projection */
.projection-box {
  border-left: 5px solid #7e57c2;
  max-width: 600px;
}

.projection-content {
  display: flex;
  justify-content: space-around;
  align-items: center;
  text-align: center;
  margin-bottom: 8px;
}

.projection-content p {
  font-size: 13px;
  color: #666;
  margin-bottom: 4px;
}

.projection-content strong {
  font-size: 20px;
  color: #7e57c2;
}

.divider {
  width: 1px;
  height: 40px;
  background: #eee;
}

.mini-note {
  font-size: 12px;
  color: #888;
  font-style: italic;
  margin-top: 6px;
  text-align: center;
}

/* Cartes Flop */
.flop-card {
  border: 1px solid #ffcdd2;
  background: #ffebee;
}
.flop-card .top-subject-title {
  color: #c62828;
}

/* Mise en page graphiques */
.charts-row {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  margin-bottom: 24px;
}

.half-width {
  flex: 1;
  min-width: 300px;
}

.chart-desc {
  font-size: 13px;
  color: #666;
  margin-bottom: 10px;
  margin-top: -10px;
}

.chart-container-small {
  position: relative;
  height: 200px;
  width: 100%;
}

.chart-container-medium {
  position: relative;
  height: 250px;
  width: 100%;
}

.stats-section {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  margin-bottom: 24px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.stats-section h2 {
  font-size: 18px;
  margin-bottom: 16px;
  color: #333;
}

/* --- STYLES PODIUM & JAUGES --- */

.podium-container {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 12px;
  height: 220px;
  padding-bottom: 10px;
}

.podium-card {
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: center;
  text-align: center;
  background: #fff;
  border-radius: 12px 12px 4px 4px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  padding: 10px;
  width: 30%;
  overflow: hidden;
  border: 1px solid #eee;
  z-index: 1;
}

.rank-1 { height: 100%; order: 2; z-index: 2; border-color: #ffd700; }
.rank-2 { height: 85%;  order: 1; border-color: #c0c0c0; }
.rank-3 { height: 70%;  order: 3; border-color: #cd7f32; }

.podium-fill {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 0%;
  transition: height 1.5s cubic-bezier(0.25, 1, 0.5, 1);
  z-index: -1;
  opacity: 0.2;
}

.top-fill { background-color: #2e7d32; }
.flop-fill { background-color: #c62828; }

.podium-content {
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
}

.podium-medal { font-size: 28px; margin-bottom: 4px; }
.podium-title { font-weight: 700; font-size: 13px; margin-bottom: 4px; line-height: 1.2; }
.podium-percent { font-size: 18px; font-weight: 800; }

/* Liste Détaillée */

/* --- SCROLL FORCE LISTE MATIÈRES (CORRIGÉ & STABILISÉ) --- */
#subjects-list {
  display: flex;
  flex-direction: column;
  gap: 12px;

  /* HAUTEUR FIXE pour éviter que ça bouge */
  height: 600px !important;      /* Taille fixe imposée */
  min-height: 600px !important;  /* Sécurité */
  overflow-y: auto !important;   /* Scroll si ça dépasse */
  
  /* ESTHÉTIQUE */
  padding: 10px;
  padding-right: 8px; 
  border: 1px solid #ccc;
  border-radius: 8px;
  background: #ffffff; 
}

/* Ajustement spécifique Dark Mode */
body.dark-mode #subjects-list {
  border-color: #444 !important;
  background: #1e1e1e !important;
}

/* --- NOUVEAUX TITRES STATS (Sections distinctes) --- */
.stats-category-title {
  font-size: 16px;
  font-weight: 700;
  color: #2f7e5f;
  margin: 20px 0 10px;
  display: flex;
  align-items: center;
  gap: 8px;
  border-bottom: 2px solid rgba(47, 126, 95, 0.1);
  padding-bottom: 5px;
}

body.dark-mode .stats-category-title {
  color: #81c784;
  border-bottom-color: rgba(255,255,255,0.1);
}

/* S'assurer que les enfants (les matières) sont bien visibles */
.subject-item {
  flex-shrink: 0; /* Empêche les éléments de s'écraser */
}

.subject-item {
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  overflow: hidden;
  transition: all 0.3s ease;
}

.subject-header {
  background: #fff;
  padding: 12px 16px;
  cursor: pointer;
  display: flex;
  align-items: center;
}

.subject-header:hover {
  background: #fafafa;
}

.subject-info {
  width: 100%;
}

.subject-name-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 6px;
  font-size: 15px;
  font-weight: 600;
}

.subject-count {
  font-size: 13px;
  color: #777;
  font-weight: 400;
}

.subject-progress-bg {
  width: 100%;
  height: 8px;
  background: #eee;
  border-radius: 999px;
  overflow: hidden;
  margin-bottom: 4px;
}

.subject-progress-fill {
  height: 100%;
  border-radius: 999px;
  transition: width 3s cubic-bezier(0.22, 1, 0.36, 1);
}

.subject-percent-text {
  text-align: right;
  font-size: 12px;
  font-weight: 700;
}

.subject-content {
  display: none;
  background: #fbfbfb;
  padding: 10px 16px;
  border-top: 1px solid #e0e0e0;
}

.subject-item.open .subject-content {
  display: block;
}

.subject-chapter {
  list-style: none;
  font-size: 13px;
  padding: 4px 0;
  color: #555;
  display: flex;
  align-items: flex-start;
}

.subject-chapter.done {
  color: #2e7d32;
  font-weight: 500;
}

/* --------- DARK MODE (Mode Sombre) --------- */

body.dark-mode {
  background: #121212;
  color: #e0e0e0;
}

body.dark-mode .header {
  background: #1b5e45;
  color: #eee;
}

body.dark-mode .nav-link {
  background: rgba(255,255,255,0.1);
  color: #ddd;
}
body.dark-mode .nav-link.active {
  background: #333;
  color: #4db6ac;
}

body.dark-mode .chapter-item,
body.dark-mode .stat-card,
body.dark-mode .stat-box,
body.dark-mode .week-day,
body.dark-mode .month-view,
body.dark-mode .review-item,
body.dark-mode .modal-content,
body.dark-mode .mini-modal-content,
body.dark-mode .subject-header,
body.dark-mode .subject-content,
body.dark-mode .podium-card,
body.dark-mode .motivation-box {
  background: #1e1e1e;
  color: #e0e0e0;
  border-color: #333;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4);
}

body.dark-mode h1, 
body.dark-mode h2, 
body.dark-mode h3 {
  color: #f5f5f5;
}

body.dark-mode .chapter-subtitle,
body.dark-mode .section-note,
body.dark-mode .modal-desc,
body.dark-mode .modal-meta,
body.dark-mode .review-meta,
body.dark-mode .stat-info h3,
body.dark-mode .chart-desc,
body.dark-mode .subject-count {
  color: #aaa;
}

body.dark-mode input[type="text"],
body.dark-mode input[type="number"],
body.dark-mode input[type="date"] {
  background: #2c2c2c;
  border: 1px solid #444;
  color: #fff;
}

body.dark-mode button.nav-button,
body.dark-mode button#btn-save,
body.dark-mode button#btn-load, 
body.dark-mode .chapter-info-btn,
body.dark-mode .review-chapter-link {
  background: #333;
  border: 1px solid #555;
  color: #4db6ac;
}

body.dark-mode .chapter-item.completed {
  background: #1e3329;
  border: 1px solid #2f7e5f;
}

body.dark-mode .week-day.today,
body.dark-mode .month-grid td.today {
  background: #263238;
  border-color: #4db6ac;
}

body.dark-mode .month-grid th {
  background: #333;
  color: #ddd;
  border-color: #444;
}
body.dark-mode .month-grid td {
  border-color: #444;
}

body.dark-mode .review-item.done,
body.dark-mode .week-review.done a,
body.dark-mode .month-review.done a {
  background: #1b3a28;
  color: #a5d6a7;
  border-left-color: #2e7d32;
}

body.dark-mode .review-item.late,
body.dark-mode .review-item.failed {
  background: #3e2723;
  border-left-color: #c62828;
}
body.dark-mode .review-item.late .review-date {
  color: #ef9a9a;
}

body.dark-mode .stat-icon {
  background: #333;
}
body.dark-mode .stat-value {
  color: #4db6ac;
}
body.dark-mode .subject-progress-bg {
  background: #333;
}
body.dark-mode .podium-fill {
  opacity: 0.3;
}


/* --- 3. RELOOKING BOUTON NOUVEAUTÉS --- */
/* Remplace tout le bloc .theme-toggle-btn2 par ceci */
.theme-toggle-btn2 {
  /* Positionnement */
  position: absolute;
  top: 20px;
  right: 20px;
  left: auto;
  margin: 0;
  transform: none;

  /* TAILLE EXACTE DU CONTENU */
  width: fit-content;  /* <--- Important : force la taille à s'adapter au contenu */
  padding: 6px 12px;   /* <--- Réduis ces chiffres pour serrer plus ou moins */
  
  /* Apparence */
  background: linear-gradient(135deg, #ff9800, #f57c00);
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 13px;
  font-weight: 700;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  cursor: pointer;
  
  /* Alignement interne (Cloche + Texte) */
  display: flex;
  align-items: center;
  gap: 6px;            /* <--- Espace entre la cloche et le texte */
  white-space: nowrap; /* <--- Empêche le texte de passer à la ligne */
  left: 85%;
  top: 170%;
  z-index: 200;
  transition: transform 0.2s;
}

.theme-toggle-btn2:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.3);
}


/* Bouton Dark Mode */
.theme-toggle-btn {
  background: rgba(0,0,0,0.2);
  border: none;
  cursor: pointer;
  font-size: 18px;
  padding: 6px 10px;
  border-radius: 50%;
  transition: transform 0.2s;
  margin-left: 0;
  color: #fff;
  /* CENTRAGE ABSOLU SUR LE HEADER */
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
    z-index: 100; /* <--- LIGNE AJOUTÉE POUR CORRIGER LE CLIC */
}
.theme-toggle-btn:hover {
  background: rgba(255,255,255,0.1);
  transform: rotate(5deg) translate(-50%, -50%);
}

/* Ajustement pour le centrage absolu */
.header-top {
  position: relative; /* Important pour que le absolute fonctionne */
}

/* Reset sur mobile */
@media (max-width: 700px) {
  .theme-toggle-btn {
    position: static;
    transform: none;
    margin-top: 0;
    margin-left: 10px;
  }
  .theme-toggle-btn:hover {
    transform: rotate(15deg);
  }
}


/* --- FEEDBACK WIDGET --- */

/* Bouton flottant en bas à droite */
.feedback-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: #2f7e5f;
  color: #fff;
  border: none;
  font-size: 24px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  cursor: pointer;
  z-index: 1900; /* Au-dessus de presque tout */
  transition: transform 0.2s, background 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.feedback-btn:hover {
  transform: scale(1.1);
  background: #25664d;
}

/* Style spécifique du modal feedback */
.feedback-content {
  max-width: 450px; /* Un peu plus étroit que les autres */
}

/* Formulaire */
.form-group {
  margin-bottom: 12px;
  text-align: left;
}

.form-group label {
  display: block;
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 4px;
  color: #444;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group textarea {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-family: inherit;
  font-size: 14px;
}

.form-group input[type="file"] {
  font-size: 13px;
}

.submit-btn {
  width: 100%;
  padding: 10px;
  background: #2f7e5f;
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 8px;
}

.submit-btn:hover {
  background: #25664d;
}

/* Dark mode support pour le formulaire */
body.dark-mode .form-group label {
  color: #ddd;
}
body.dark-mode .form-group input,
body.dark-mode .form-group textarea {
  background: #2c2c2c;
  border-color: #444;
  color: #fff;
}


/* ... Code existant ... */

/* --- CHANGELOG (NOUVEAUTÉS) --- */

.news-content {
  /* On l'élargit un peu */
  max-width: 600px;
  
  /* HAUTEUR : On force 80% de la hauteur de l'écran */
  height: 90vh;       
  
  /* Flexbox pour gérer le scroll interne proprement */
  display: flex;
  flex-direction: column;
}

.changelog-list {
  /* Prend toute la place restante en hauteur */
  flex: 1;
  
  /* On enlève la limite précédente */
  max-height: none; 
  
  /* On active le scroll ici */
  overflow-y: auto;
  
  /* Un peu d'espace en bas */
  margin-bottom: 10px;
  padding-right: 10px; /* Pour éviter que le scroll cache le texte */
}

.changelog-item {
  position: relative;
  padding-left: 20px;
  border-left: 3px solid #eee; /* La ligne verticale */
  padding-bottom: 24px;
}

.changelog-item:last-child {
  border-left-color: transparent;
}

/* La petite boule sur la ligne */
.changelog-item::before {
  content: "";
  position: absolute;
  left: -8px; 
  top: 0;
  width: 13px;
  height: 13px;
  background: #2f7e5f;
  border-radius: 50%;
  border: 2px solid #fff;
}

.changelog-date {
  font-size: 11px;
  text-transform: uppercase;
  color: #888;
  margin-bottom: 4px;
  font-weight: 700;
}

.changelog-version {
  font-size: 16px;
  margin-bottom: 8px;
  color: #2f7e5f;
}

.changelog-details {
  padding-left: 16px;
  margin: 0;
  font-size: 14px;
  color: #444;
  line-height: 1.5;
}

.changelog-details li {
  margin-bottom: 4px;
}

/* Dark Mode pour le changelog */
body.dark-mode .changelog-item {
  border-left-color: #333;
}
body.dark-mode .changelog-item::before {
  border-color: #1e1e1e;
}
body.dark-mode .changelog-details {
  color: #ddd;
}
body.dark-mode .changelog-version {
  color: #4db6ac;
}

/* --- AJOUTS V2.2 : Paramètres & Objectifs --- */

/* Bouton Paramètres (Index) */
.settings-btn {
  /* Apparence */
  background: rgba(255, 255, 255, 0.2);
  border: 1px solid rgba(255,255,255,0.6);
  color: white;
  border-radius: 8px; /* Un peu plus arrondi */
  
  /* TAILLE : Modifie ces 2 lignes pour ajuster */
  padding: 10px 20px;  /* Hauteur, Largeur (essaie 10px 20px si tu veux encore plus gros) */
  font-size: 16px;    /* Taille du texte */
  
  /* Comportement */
  cursor: pointer;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 5px;
  transition: all 0.2s ease;
}

.settings-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: scale(1.05); /* Petit effet de grossissement au survol */
}

/* Modal Paramètres */
.settings-group {
  margin-bottom: 16px;
  border-bottom: 1px solid #eee;
  padding-bottom: 16px;
}
.settings-group label {
  display: block;
  font-weight: 600;
  margin-bottom: 6px;
  font-size: 14px;
}
.settings-group input[type="date"],
.settings-group input[type="text"] {
  width: 100%;
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 6px;
}
.settings-note {
  font-size: 12px;
  color: #666;
  margin-top: 4px;
  font-style: italic;
}

/* Section Objectifs (Stats) */
.goals-section {
  background: #fff;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 24px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  border-left: 5px solid #29b6f6;
}
.goals-container {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  align-items: flex-end;
}
.goal-input-group {
  flex: 1;
  min-width: 200px;
}
.goal-input-group label {
  font-size: 13px;
  font-weight: 600;
  color: #555;
  display: block;
  margin-bottom: 4px;
}
.goal-input-wrapper {
  display: flex;
  align-items: center;
  gap: 8px;
}
.goal-input-wrapper input {
  width: 70px;
  padding: 6px;
  border: 1px solid #ddd;
  border-radius: 6px;
  text-align: center;
}
.goal-progress {
  margin-top: 8px;
  height: 8px;
  background: #eee;
  border-radius: 999px;
  overflow: hidden;
}
.goal-progress-bar {
  height: 100%;
  background: #29b6f6;
  transition: width 1.0s;
}
.goal-text {
  font-size: 12px;
  margin-top: 4px;
  color: #666;
  text-align: right;
}

/* Recherche Matière (Stats) */
.subject-search-container {
  margin-bottom: 16px;
}
.subject-search-input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 14px;
}

/* Dark Mode updates */
body.dark-mode .settings-group { border-bottom-color: #333; }
body.dark-mode .settings-note { color: #aaa; }
body.dark-mode .goals-section { background: #1e1e1e; border-left-color: #0288d1; }
body.dark-mode .goal-input-group label { color: #ccc; }
body.dark-mode .goal-input-wrapper input, 
body.dark-mode .subject-search-input { background: #2c2c2c; border-color: #444; color: #fff; }
body.dark-mode .goal-progress { background: #333; }

/* --- Groupe Titre + Paramètres --- */
.header-title-group {
  display: flex;
  flex-direction: column; /* Empile le titre et le bouton */
  align-items: flex-start; /* Aligne à gauche */
  gap: 5px; /* Petit espace entre le titre et le bouton */
}

/* Ajustement du bouton Paramètres */
.settings-btn {
  background: rgba(255, 255, 255, 0.15); /* Fond léger pour qu'il ressorte */
  border: 1px solid rgba(255,255,255,0.4);
  color: white;
  border-radius: 6px; /* Moins rond pour faire plus "bouton outil" */
  padding: 4px 10px;
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: 0; /* On annule la marge précédente */
  transition: all 0.2s ease;
}

.settings-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: translateY(-1px);
}


/* --- CORRECTIFS DARK MODE & CSS (V2.3) --- */

/* 1. Page Planning : Les 3 boutons du sous-menu (Re-révisions, Hebdo, Mensuel) */
body.dark-mode .sub-nav a {
  background: #2c2c2c;       /* Fond gris foncé */
  color: #4db6ac;            /* Texte vert d'eau */
  border: 1px solid #444;    /* Légère bordure */
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
}

body.dark-mode .sub-nav a:hover {
  background: #3e3e3e;
  color: #fff;
  transform: translateY(-1px);
}

/* 2. Page Stats : Les encadrés blancs (Graphiques, Top/Flop, Liste détaillée) */
body.dark-mode .stats-section {
  background: #1e1e1e;       /* Fond foncé unifié */
  color: #e0e0e0;            /* Texte clair */
  border: 1px solid #333;    /* Bordure subtile */
  box-shadow: 0 4px 12px rgba(0,0,0,0.3); /* Ombre plus marquée */
}

/* Titres dans les sections stats */
body.dark-mode .stats-section h2 {
  color: #ffffff;
}

/* 3. Page Stats : Liste détaillée des matières */
body.dark-mode .subject-item {
  border-color: #444;        /* Bordure des items de la liste */
  background: transparent;   /* Pour laisser voir le fond de la section */
}

/* Header de la matière (la barre cliquable) */
body.dark-mode .subject-header {
  background: #262626;
  color: #e0e0e0;
}

body.dark-mode .subject-header:hover {
  background: #333;
}

/* Contenu déroulant (les chapitres) */
body.dark-mode .subject-content {
  background: #1a1a1a;
  border-top: 1px solid #444;
}

/* Texte des chapitres dans la liste */
body.dark-mode .subject-chapter {
  color: #aaa;
}
body.dark-mode .subject-chapter.done {
  color: #66bb6a; /* Vert plus lumineux pour le dark mode */
}


/* --- CORRECTIF LAYOUT HEADER (Boutons + Motivation) --- */

/* Conteneur pour aligner Motivation (Gauche) et Paramètres (Centre) */
.header-bottom-row {
  position: relative;
  display: flex;
  justify-content: center; /* Centre le bouton Paramètres */
  align-items: center;
  margin-top: 15px;
  min-height: 40px;
}

/* Le bouton Motivation reste à gauche */
.header .motivation-btn {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  margin: 0;
}

/* Le bouton Paramètres est au centre (flux normal du flex) */
.header #btn-settings {
  position: static !important; /* On annule l'absolu */
  transform: none !important;
  margin: 0 !important;
}

/* La boîte de texte passe EN DESSOUS de tout ça */
.motivation-box {
  margin-top: 15px;
  position: relative;
  z-index: 50;
  /* On s'assure qu'elle pousse le contenu si besoin ou s'affiche proprement */
}

/* Mobile : On empile tout proprement */
@media (max-width: 650px) {
  .header-bottom-row {
    flex-direction: column;
    gap: 10px;
  }
  .header .motivation-btn {
    position: static;
    transform: none;
  }
}

/* Sécurité Mobile : Sur petit écran, on annule l'absolu pour qu'il ne chevauche pas */
@media (max-width: 650px) {
  .header > #btn-settings {
    position: static;
    transform: none;
    margin: 10px auto 0;
    display: table;
  }
}

/* --- CORRECTIF DARK MODE : MODALE RÉVISIONS --- */

/* 1. Les lignes de révision (non faites) */
body.dark-mode .modal-review-item {
  background: #2c2c2c;       /* Fond gris foncé au lieu de blanc */
  border: 1px solid #444;    /* Bordure discrète */
  color: #e0e0e0;            /* Texte clair */
}

/* 2. Les lignes de révision (FAITES / CHECKÉES) */
body.dark-mode .modal-review-item.done {
  background: #1b3a28;       /* Fond vert très foncé */
  border-left-color: #43a047; /* Bordure verte plus lumineuse */
  color: #a5d6a7;            /* Texte vert clair */
}

/* 3. Le bouton de fermeture (croix) */
body.dark-mode .modal-close {
  color: #fff;               /* Croix blanche */
}
body.dark-mode .modal-close:hover {
  background: #333;          /* Fond gris au survol */
}

/* 4. Barre de progression dans la modale */
body.dark-mode .modal-progress-bg {
  background: #444;          /* Fond de la barre gris foncé */
}

/* 5. Bouton "Annuler report" (s'il apparait) */
body.dark-mode .modal-review-reset-btn {
  background: #444;
  border-color: #555;
  color: #ccc;
}
body.dark-mode .modal-review-reset-btn:hover {
  background: #555;
}

/* --- BOUTON INFO COOKIES --- */
.info-btn {
  background: #e3f2fd;    /* Bleu très clair */
  color: #1565c0;         /* Bleu foncé */
  border: 1px solid #90caf9;
  padding: 8px 12px;      /* Carré/Arrondi */
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  line-height: 1;
  transition: all 0.2s;
}

.info-btn:hover {
  background: #bbdefb;
  transform: translateY(-1px);
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

/* Dark Mode pour le bouton info et le warning */
body.dark-mode .info-btn {
  background: #263238;
  color: #90caf9;
  border-color: #546e7a;
}
body.dark-mode .info-btn:hover {
  background: #37474f;
}

/* Texte spécifique de la modale info en dark mode */
body.dark-mode h3[style*="color: #d32f2f"] {
  color: #ef5350 !important; /* Rouge plus clair pour le titre */
}
body.dark-mode div[style*="background:#ffebee"] {
  background: #3e2723 !important; /* Fond rouge très sombre */
  border-color: #b71c1c !important;
  color: #ffcdd2 !important;      /* Texte rouge clair */
}

/* --- FORCAGE TAILLE BOUTON PARAMÈTRES --- */
#btn-settings {
  padding: 6px 8px !important;  /* Ajuste ces chiffres (Haut/Bas  Gauche/Droite) */
  font-size: 15px !important;     /* Ajuste la taille du texte */
  width: auto !important;         /* Laisse le bouton s'élargir selon le texte */
}

/* --- CROIX DE SUPPRESSION RECHERCHE --- */
.search-wrapper, 
.subject-search-container {
  position: relative; /* Nécessaire pour placer la croix */
}

.search-clear-btn {
  position: absolute;
  right: 10px;
  top: 27%;
  transform: translateY(-10%);
  background: none;
  border: none;
  color: #999;
  font-size: 16px;
  cursor: pointer;
  display: none; /* Caché par défaut si vide */
  padding: 0 5px;
}

.search-clear-btn:hover {
  color: #d32f2f;
}

/* Ajustement input pour laisser place à la croix */
.search-wrapper input,
.subject-search-container input {
  padding-right: 30px !important;
}

/* --- GESTION RESPONSIVE (MOBILE / TABLETTE) --- */

/* Dès que l'écran fait moins de 900px de large */
@media (max-width: 950px) {
  
  /* 1. On passe le haut du header en mode "Colonne" (vertical) */
  .header-top {
    flex-direction: column;
    align-items: center;
    gap: 15px;
    padding-bottom: 10px;
  }

  /* 2. On annule le positionnement absolu du bouton Nouveautés */
  .theme-toggle-btn2 {
    position: static !important; /* Redevient un élément normal */
    transform: none !important;
    margin: 5px auto; /* Centré */
    order: 3; /* On décide de l'afficher en 3ème position */
  }

  /* 3. On annule le positionnement absolu du bouton Mode Sombre */
  .theme-toggle-btn {
    position: static !important;
    transform: none !important;
    margin: 5px auto;
    order: 2; /* Juste avant les nouveautés */
  }

  /* 4. On s'assure que le titre et le bouton paramètre restent en haut */
  .header-title-group {
    align-items: center;
    width: 100%;
    order: 1;
    margin-bottom: 10px;
  }
  
  /* 5. On ajuste la navigation pour qu'elle prenne de la place si besoin */
  .main-nav {
    flex-wrap: wrap;
    justify-content: center;
    order: 4;
    margin-top: 10px;
  }

  /* 6. On gère le bas du header (Motivation + Paramètres du bas) */
  .header-bottom-row {
    flex-direction: column; /* On empile verticalement */
    gap: 15px;
    margin-top: 20px;
  }

  /* On remet les boutons du bas dans le flux normal */
  .header .motivation-btn,
  .header > #btn-settings {
    position: static !important;
    transform: none !important;
    width: fit-content;
    margin: 0 auto;
  }
}

/* --- NAVIGATION CENTRÉE (PLANNING & STATS) --- */

/* On applique le style aux deux classes d'un coup */
.planning-nav-center {
  display: flex;
  gap: 20px;
  margin-right: 40px; /* Plus ce chiffre est grand, plus ça part à gauche */
}

.stats-nav-center {
  display: flex;
  gap: 20px;
  margin-right: 2px;
}

/* Style des liens (boutons) pour les deux pages */
.planning-nav-center a,
.stats-nav-center a {
  display: inline-block;
  padding: 6px 14px;
  background: rgba(255, 255, 255, 0.2);
  color: #fff;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  text-decoration: none;
  border: 1px solid rgba(255, 255, 255, 0.4);
  transition: all 0.2s ease;
}

.planning-nav-center a:hover,
.stats-nav-center a:hover {
  background: rgba(255, 255, 255, 0.35);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

/* RESPONSIVE : Sur mobile, on recentre tout */
@media (max-width: 950px) {
  .planning-nav-center,
  .stats-nav-center {
    flex-wrap: wrap;
    justify-content: center;
    width: 100%;
    margin-right: 0; /* On annule le décalage sur mobile */
  }
}

/* --- RESPONSIVE : ORDRE DES CONTRÔLES (Sauvegarde en haut sur mobile) --- */

@media (max-width: 30000px) {
  /* On force la section de contrôles à s'empiler verticalement */
  .controls {
    flex-direction: column;
    align-items: stretch; /* Prend toute la largeur */
    gap: 12px;
  }

  /* 1. On force le bloc BOUTONS à passer en PREMIER */
  .buttons-wrapper {
    order: 1; 
    
    /* On empile aussi les boutons les uns sur les autres pour qu'ils soient gros et cliquables */
    display: flex;
    flex-direction: column; 
    gap: 8px;
    margin-bottom: 10px;
    width: 100%;
  }

  /* Les boutons prennent toute la largeur sur mobile */
  .buttons-wrapper button,
  .buttons-wrapper .info-btn {
    width: 100%;
    justify-content: center;
  }

  /* 2. La barre de recherche passe en DEUXIÈME */
  .search-wrapper {
    order: 2;
    max-width: 100%; /* S'assure qu'elle prend la largeur dispo */
    flex: 1 1 auto;
  }

  /* 3. Les filtres passent en DERNIER */
  .filters-wrapper {
    order: 3;
    margin-top: 5px;
  }
}

/* --- Styles des Selects de Tri --- */

.sort-select {
  padding: 8px 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  background-color: #fff;
  font-size: 14px;
  cursor: pointer;
  color: #333;
  outline: none;
  transition: border-color 0.2s, box-shadow 0.2s;
  /* Pour aligner avec la hauteur des inputs */
  height: 38px; 
}

.sort-select:hover {
  border-color: #2f7e5f;
}

.sort-select:focus {
  border-color: #2f7e5f;
  box-shadow: 0 0 0 2px rgba(47, 126, 95, 0.2);
}

/* Dark Mode pour les Selects */
body.dark-mode .sort-select {
  background-color: #2c2c2c;
  border-color: #444;
  color: #fff;
}

body.dark-mode .sort-select:hover {
  border-color: #4db6ac;
}

/* Ajustement responsive pour la barre de recherche stats */
@media (max-width: 600px) {
  .subject-search-container {
    flex-direction: column;
  }
  .sort-select {
    width: 100%;
  }
}

/* --- CORRECTIF LAYOUT V2.4 : Boutons ajustés & Ligne de recherche --- */

/* 1. Conteneur principal */
.controls {
  display: flex;
  flex-direction: column; /* Ligne 1 : Boutons, Ligne 2 : Recherche */
  gap: 15px;
  align-items: center;    /* Tout centrer */
  margin-bottom: 30px;
}

/* 2. Les Boutons (Sauvegarder, Charger, Info) */
.buttons-wrapper {
  display: flex !important;
  flex-direction: row !important; /* Force l'alignement horizontal */
  flex-wrap: wrap;                /* Revient à la ligne si écran minuscule */
  justify-content: center;
  gap: 10px;
  width: 100%;
  order: 1; /* On s'assure qu'ils restent en haut */
}

/* Taille adaptée au texte (Auto) */
.buttons-wrapper button, 
.buttons-wrapper .info-btn {
  width: auto !important;     /* C'EST ICI LA CLÉ : on annule le 100% */
  min-width: 0;
  padding: 8px 16px;
  white-space: nowrap;        /* Empêche le texte de se casser */
  font-size: 14px;
}

/* 3. La ligne Recherche + Filtres + Tris */
.search-tools {
  display: flex;
  flex-wrap: wrap; /* Permet de passer à la ligne sur mobile */
  align-items: center;
  justify-content: center;
  gap: 15px; /* Espace entre Recherche, Checkbox et Tri */
  width: 100%;
  order: 2;
}

/* Groupe Recherche */
.search-group {
  position: relative;
  display: flex;
  align-items: center;
}

.search-group input {
  padding: 8px 30px 8px 10px; /* Place pour la croix */
  border: 1px solid #ccc;
  border-radius: 6px;
  width: 220px; /* Taille fixe confortable */
}

/* Groupe Tri */
.sort-group {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 14px;
  font-weight: 600;
}

/* Checkbox compacte */
.filter-checkbox {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  white-space: nowrap;
}

/* --- RESPONSIVE MOBILE (Surcharge finale) --- */
@media (max-width: 700px) {
  /* Sur mobile, on autorise la recherche à prendre toute la largeur si besoin */
  .search-group input {
    width: 100%;
    min-width: 200px;
  }
  
  /* On s'assure que les boutons ne s'empilent pas bêtement sauf si nécessaire */
  .buttons-wrapper {
    width: 100% !important;
  }
}

/* --- PROTECTION ANTI-COPIE --- */
body {
  /* Empêche la sélection de texte sur tout le site */
  -webkit-user-select: none; /* Safari */
  -moz-user-select: none;    /* Firefox */
  -ms-user-select: none;     /* IE10+/Edge */
  user-select: none;         /* Standard */
}

/* On ré-autorise la sélection UNIQUEMENT dans les champs de texte
   pour que l'utilisateur puisse quand même taper ses recherches/notes */
input, textarea {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

/* --- CORRECTIF DARK MODE V2.4 (Barre d'outils) --- */

/* 1. La barre de recherche et le menu de tri */
body.dark-mode .search-group input,
body.dark-mode .sort-select {
  background-color: #2c2c2c;  /* Gris foncé */
  color: #ffffff;             /* Texte blanc */
  border-color: #555;         /* Bordure plus discrète */
}

/* Au survol */
body.dark-mode .sort-select:hover,
body.dark-mode .search-group input:focus {
  border-color: #4db6ac;      /* Bordure verte au focus */
}

/* 2. Le texte du label "Appris" et "Trier :" */
body.dark-mode .filter-checkbox,
body.dark-mode .sort-group label {
  color: #e0e0e0;             /* Texte quasi blanc */
}

/* 3. La croix "Effacer" dans la recherche */
body.dark-mode .search-clear-btn {
  color: #bbb;
}
body.dark-mode .search-clear-btn:hover {
  color: #ef5350;             /* Rouge clair au survol */
}

/* 4. Le bouton "i" (Infos) en mode sombre */
body.dark-mode .info-btn {
  background-color: #37474f;  /* Bleu gris très foncé */
  color: #90caf9;             /* Bleu clair */
  border-color: #546e7a;
}
body.dark-mode .info-btn:hover {
  background-color: #455a64;
  color: #ffffff;
}

/* --- CORRECTIF FINAL DARK MODE : MODALE INFOS --- */

/* 1. Rendre le texte des astuces lisible (Gris foncé -> Blanc cassé) */
body.dark-mode #info-modal ul {
  color: #e0e0e0 !important; 
}

/* 2. Adapter la boîte d'alerte rouge (Fond blanc -> Fond rouge sombre) */
body.dark-mode #info-modal div[style*="background:#fff5f5"] {
  background-color: #3e2723 !important; /* Rouge très sombre */
  border-color: #b71c1c !important;     /* Bordure rouge */
  color: #ffcdd2 !important;            /* Texte rouge clair */
}

/* 3. Le titre "Attention aux données" (Rouge vif -> Rouge clair) */
body.dark-mode #info-modal h3[style*="color: #d32f2f"] {
  color: #ef5350 !important;
}

/* 4. Le texte à l'intérieur de l'alerte */
body.dark-mode #info-modal p[style*="color:#b71c1c"] {
  color: #ffcdd2 !important;
}

/* 5. Le titre bleu "Astuces d'utilisation" (Bleu foncé -> Bleu clair) */
body.dark-mode #info-modal h3[style*="color: #1565c0"] {
  color: #90caf9 !important;
}

/* 6. Le grand titre vert "Informations & Astuces" */
body.dark-mode #info-modal h2[style*="color: #2f7e5f"] {
  color: #81c784 !important;
}

/* 7. Le séparateur (ligne grise) */
body.dark-mode #info-modal hr {
  border-top-color: #444 !important;
}

/* --- AMÉLIORATION LISIBILITÉ MODALE INFOS --- */

/* 1. Espacement général de la liste */
#info-modal ul {
  gap: 20px !important; /* Plus d'espace entre les blocs */
}

/* 2. Chaque astuce (l'élément li) */
#info-modal li {
  padding-bottom: 15px;            /* Espace interne en bas */
  border-bottom: 1px solid #eee;   /* Ligne de séparation grise claire */
  align-items: flex-start !important; /* Aligne l'icône en haut */
}

/* On enlève la ligne pour le dernier élément */
#info-modal li:last-child {
  border-bottom: none;
}

/* 3. Les Titres (les balises <strong>) */
#info-modal li strong {
  display: block;                  /* Le titre prend toute la largeur (passe à la ligne) */
  font-size: 15px;                 /* Un peu plus gros */
  color: #1565c0;                  /* Bleu pour bien ressortir en mode jour */
  margin-bottom: 4px;              /* Espace sous le titre */
  text-decoration: underline;      /* Soulignement demandé */
  text-underline-offset: 3px;      /* Le trait un peu décollé du texte */
  text-decoration-color: #b3e5fc;  /* Soulignement plus clair que le texte */
}

/* --- ADAPTATION MODE SOMBRE (Dark Mode) --- */

body.dark-mode #info-modal li {
  border-bottom-color: #444;       /* Ligne de séparation plus sombre */
}

body.dark-mode #info-modal li strong {
  color: #90caf9;                  /* Bleu clair lumineux */
  text-decoration-color: #1e88e5;  /* Soulignement bleu discret */
}

/* --- CENTRAGE TITRE ASTUCES --- */
#info-modal h3[style*="color: #1565c0"] {
  text-align: center !important;
  margin-top: 10px; /* Un petit peu d'espace au-dessus pour aérer */
}

/* --- AJOUTS V3 : Advanced Settings & UI --- */

/* Zone des tags (Jours exclus / Vacances) */
.tags-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
  margin-bottom: 12px;
  min-height: 30px;
}

.tag-item {
  background: #e3f2fd;
  color: #1565c0;
  border: 1px solid #90caf9;
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.tag-remove {
  cursor: pointer;
  font-weight: bold;
  font-size: 14px;
  color: #d32f2f;
}

.tag-remove:hover {
  color: #b71c1c;
}

/* Lignes cliquables dans les modales (UX) */
.modal-review-item, 
.review-item {
  cursor: pointer; /* Indique que c'est cliquable */
  transition: background 0.2s;
}

.modal-review-item:hover,
.review-item:hover {
  background-color: #f0f0f0;
}

/* Dark Mode pour les tags */
body.dark-mode .tag-item {
  background: #263238;
  color: #90caf9;
  border-color: #546e7a;
}
body.dark-mode .tag-remove {
  color: #ef5350;
}
body.dark-mode .modal-review-item:hover,
body.dark-mode .review-item:hover {
  background-color: #333;
}

/* Inputs alignés pour les périodes */
.period-inputs {
  display: flex;
  gap: 8px;
  align-items: center;
}
.period-inputs input {
  flex: 1;
}

/* --- CORRECTIF DARK MODE : INPUTS NATIFS (Calendrier & Select) --- */

body.dark-mode {
  /* C'est LA ligne magique qui force les popups système (calendrier, select) en noir */
  color-scheme: dark; 
}

/* On s'assure que les champs eux-mêmes (au repos) sont bien stylés */
body.dark-mode input[type="date"],
body.dark-mode select {
  background-color: #2c2c2c;
  color: #ffffff;
  border: 1px solid #555;
}

/* Petite astuce pour que l'icône du calendrier (la petite grille) soit blanche */
body.dark-mode ::-webkit-calendar-picker-indicator {
  filter: invert(1);
  cursor: pointer;
}